# ROSツール
ROSの長所の1つとして、可視化ツールなどの様々なツールを利用できることが挙げられます。ここでは基本的なツールを紹介します。

roslaunchコマンドでturtlesimを実行したあと、別のターミナルを開いて確認してみてください。

## rqt_graph  
ROSノード同士の繋がりを確認することができます。閉じるボタンか「Ctrlキー」＋「cキー」でrqt_graphを停止することができます。
```
$ rosrun rqt_graph rqt_graph（※正式な方法）
又は
$ rqt_graph（※簡便な方法）
```
名前が「/teleop_turtle」というturtle_teleop_keyタイプのノードと、名前が「/turtlesim」というturtlesim_nodeタイプのノードが、ROSトピック「/turtle1/cmd_vel」で繋がっていることが確認できると思います。このトピックが速度情報を伝達するため、キーボードで亀を動かすことができます。  

## rostopic
まずは下記のコマンドでトピックの一覧を確認してみましょう。  
```
$ rostopic list
```
下記のコマンドでトピックの値を確認してみましょう。「Ctrlキー」＋「cキー」でrostopic echoを終了します。  
```
$ rostopic echo /turtle1/cmd_vel
```
矢印キーを押して亀を動かすたびに、値が出力されると思います。重要なポイントは、/teleop_turtleノードは速度情報を配信しているだけ、/turtlesimノードは速度情報を購読しているだけで、どのノードが配信・購読しているかは全く関係ないところです。つまり、速度情報を出すのが、キーボードでも、マウスでも、ジョイスティックでも、画像処理の結果でも、音声処理の結果でも、何でも大丈夫です。同様に、キーボードだけで、バーチャルなロボットも、リアルなロボットも、自動車も、ドローンも、何でも操作することができます。これがROSの利点です！  

もちろん、ターミナルから直接、速度情報を出すこともできます。まず、ROSトピック「/turtle1/cmd_vel」の型（メッセージ型）を確認してみます。
```
$ rostopic type /turtle1/cmd_vel
```
出力を確認すると「geometry_msgs/Twist」という型であることが分かります。もちろんintなどの単純な型（std_msgs/Int32）も存在しますが、ROSはロボット用のソフトウェアなので、いくつかの変数がまとまった構造体のような型を利用することが多いです。

次のコマンドで詳しく調べてみると、メッセージ型「geometry_msgs/Twist」は２つの３次元ベクトル（linearとangular）で構成されており、それぞれの値はfloatであることが分かります。  
```
$ rosmsg show geometry_msgs/Twist
```  
そして、下記のようなコマンドで６つの値を配信することができます。１つ目の値で前進量、６つ目の値で回転量を指定することができます。ちなみに回転方向は反時計回りが正になるので注意しましょう。
```
$ rostopic pub /turtle1/cmd_vel geometry_msgs/Twist -- '[1.0,0.0,0.0]' '[0.0,0.0,0.0]'
```  
上記のコマンドでは、毎回「Ctrlキー」＋「cキー」で停止する必要があります。そこで、下記のようにオプション「-1」を付けることで、１回実行後に自動で終了させることもできます。  
```
$ rostopic pub -1 /turtle1/cmd_vel geometry_msgs/Twist -- '[0.0,0.0,0.0]' '[0.0,0.0,3.14]'
```


#### rosparam  
roscoreコマンドを実行し、ROSマスターが起動すると、ROSパラメーターサーバーも一緒に起動します。このサーバーを介して、グローバル変数のように全てのノードで利用可能な変数を共有することができます。  

下記のコマンドを実行すると、どんなパラメーターがあるかを確認することができます。  
```
$ rosparam list
```
下記のコマンドで具体的な値を確認してみましょう。
```
$ rosparam get /background_b
```
値を変更してみましょう。
```
$ rosparam set /background_b 0
```  
パラメーターはノードを生成した時に読み込むため、強制的に再読み込みを行い、変更内容を反映させます。  
```
$ rosservice call /clear
```
亀のウィンドウの背景色が変わると思います。  

[トップへ](#)
